<!-- Auto generated content below. DO NOT edit manually, but run tox -egenerate-monitor-docs command instead -->

# PostgreSQL Monitor

The PostgreSQL monitor allows you to collect data about the usage and performance of your PostgreSQL server.

Each monitor can be configured to monitor a specific PostgreSQL database, thus allowing you to configure alerts and the
dashboard entries independently (if desired) for each instance.

## Configuring PostgreSQL

To use Scalyr's PostgreSQL monitor, you will first need to configure your PostgreSQL server to enable password
authentication for a user as well as configure a user to connect to the database and gather the necessary data.

To configure PostgreSQL for password authentication, you will need a line like the following in your pg_hba.conf
file:

    host    all             all             127.0.0.1/32            md5

To create a user and enable password authentication, please consult the PostgreSQL documentation.  For version
9.3, that documentation can be found here:  http://www.postgresql.org/docs/9.3/static/sql-createrole.html

### Configuring the PostgreSQL monitor

The PostgreSQL monitor is included with the Scalyr agent.  In order to configure it, you will need to add its monitor
configuration to the Scalyr agent config file.

A basic PostgreSQL monitor configuration entry might resemble:

  monitors: [
    {
      module:              "scalyr_agent.builtin_monitors.postgres_monitor",
      id:                  "mydb",
      database_host:       "localhost",
      database_name:       "<database>",
      database_username:   "<username>",
      database_password:   "<password>"
    }
  ]

Note the ``id`` field in the configurations.  This is an optional field that allows you to specify an identifier
specific to a particular instance of PostgreSQL and will make it easier to filter on metrics specific to that
instance.

## Configuration Reference

|||# Option               ||| Usage
|||# ``module``           ||| Always ``scalyr_agent.builtin_monitors.postgres_monitor ``
|||# ``id``               ||| Optional. Included in each log message generated by this monitor, as a field named \
                              ``instance``. Allows you to distinguish between values recorded by different monitors. \
                              This is especially useful if you are running multiple PostgreSQL instances on a single \
                              server; you can monitor each instance with a separate postgresql_monitor record in the \
                              Scalyr Agent configuration.
|||# ``database_host``    ||| Name of host machine the agent will connect to PostgreSQL to retrieve monitoring data.
|||# ``database_port``    ||| Name of port on the host machine the agent will connect to PostgreSQL to retrieve \
                              monitoring data.
|||# ``database_name``    ||| Name of database the agent will connect to PostgreSQL to retrieve monitoring data.
|||# ``database_username``||| Username which the agent uses to connect to PostgreSQL to retrieve monitoring data.
|||# ``database_password``||| Password for connecting to PostgreSQL.

## Log reference

Each event recorded by this plugin will have the following fields:

|||# Field       ||| Meaning
|||# ``monitor`` ||| Always ``postgres_monitor``.
|||# ``instance``||| The ``id`` value from the monitor configuration.
|||# ``metric``  ||| The name of a metric being measured, e.g. "postgres.vars".
|||# ``value``   ||| The metric value.

## Metrics

The table below describes the metrics recorded by the monitor.


### connections metrics

|||# Metric                            ||| Description
|||# ``postgres.database.connections`` ||| The number of current active connections.  The value is accurate to when the \
                                           check was made.

### general metrics

|||# Metric                               ||| Fields                ||| Description
|||# ``postgres.database.transactions``   ||| ``result=committed``  ||| The number of database transactions that have been \
                                                                        committed.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.transactions``   ||| ``result=rolledback`` ||| The number of database transactions that have been \
                                                                        rolled back.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.disk_blocks``    ||| ``type=read``         ||| The number of disk blocks read into the database.  \
                                                                        The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.disk_blocks``    ||| ``type=hit``          ||| The number of disk blocks read that were found in \
                                                                        the buffer cache.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.query_rows``     ||| ``op=returned``       ||| The number of rows returned by all queries in the \
                                                                        database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.query_rows``     ||| ``op=fetched``        ||| The number of rows fetched by all queries in the \
                                                                        database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.query_rows``     ||| ``op=inserted``       ||| The number of rows inserted by all queries in the \
                                                                        database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.query_rows``     ||| ``op=updated``        ||| The number of rows updated by all queries in the \
                                                                        database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.query_rows``     ||| ``op=deleted``        ||| The number of rows deleted by all queries in the \
                                                                        database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.temp_files``     |||                       ||| The number of temporary files created by queries \
                                                                        to the database.  The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.temp_bytes``     |||                       ||| The total amount of data written to temporary \
                                                                        files by queries to the database.  The value is \
                                                                        relative to postgres.database.stats_reset.
|||# ``postgres.database.deadlocks``      |||                       ||| The number of deadlocks detected in the database.  \
                                                                        The value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.blocks_op_time`` ||| ``op=read``           ||| The amount of time data file blocks are read by \
                                                                        clients in the database (in milliseconds).  The \
                                                                        value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.blocks_op_time`` ||| ``op=write``          ||| The amount of time data file blocks are written by \
                                                                        clients in the database (in milliseconds).  The \
                                                                        value is relative to \
                                                                        postgres.database.stats_reset.
|||# ``postgres.database.stats_reset``    |||                       ||| The time at which database statistics were last \
                                                                        reset.
|||# ``postgres.database.size``           |||                       ||| The number of bytes the database is taking up on \
                                                                        disk.
